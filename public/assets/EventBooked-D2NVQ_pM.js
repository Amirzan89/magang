import{d as j,u as q,r as i,b as K,e as W,f as $,g as J,c as _,o as h,l as a,w as l,n as r,ae as m,af as v,s as f,t as y,j as z,a as b,K as Q,F as X,k as Y}from"./index-BnukgSfD.js";import{f as D}from"./global-B2HkdVGL.js";const Z={class:"card"},ee={class:"flex justify-between items-center"},ae={key:0,class:"flex flex-col gap-3"},te={class:"font-semibold"},re=j({__name:"EventBooked",setup(le){const P=J(),{reqData:S}=$(),C=q(),w=i(),T=K({fetchData:[]}),d=i(null),V=i(!0),p=i(null),c=i(!1),x=i(0),N=i(10),F=t=>{x.value=t.first,N.value=t.rows},k=()=>{d.value={global:{value:null,matchMode:m.CONTAINS},registrationname:{operator:v.AND,constraints:[{value:null,matchMode:m.STARTS_WITH}]},email:{operator:v.AND,constraints:[{value:null,matchMode:m.CONTAINS}]},registrationdate:{operator:v.AND,constraints:[{value:null,matchMode:m.DATE_IS}]},eventgroup:{operator:v.AND,constraints:[{value:null,matchMode:m.STARTS_WITH}]}}};k();const I=()=>{k()},A=t=>{p.value={...t},c.value=!0},U=()=>c.value=!1;W(async()=>{const t=await S({url:"/api"+P.path,method:"POST",reqType:"Json"});if(V.value=!1,t.status=="error"){C.add({severity:"error",summary:"Gagal Ambil Data Halaman",detail:t.message,group:"br",life:3e3});return}T.fetchData=t.data.map(o=>({...o,registrationdate:new Date(o.registrationdate)}))});const R=()=>w.value.exportCSV(),B={registrationno:{label:"Registration No"},registrationname:{label:"Name"},mobileno:{label:"Mobile Number"},gender:{label:"Gender",format:t=>t=="M  "?"Male":"Female"},email:{label:"Email"},registrationdate:{label:"Registration Date",format:t=>D(new Date(t))},paymentdate:{label:"Payment Date",format:t=>D(new Date(t))},paymentamount:{label:"Payment Amount",format:t=>`${Number(t).toLocaleString("id-ID")}`},paymenttype:{label:"Payment Type"},registrationstatus:{label:"Status"},notes:{label:"Notes"}};return(t,o)=>{const g=r("Button"),L=r("Toolbar"),E=r("InputIcon"),u=r("InputText"),M=r("IconField"),s=r("Column"),G=r("DatePicker"),O=r("DataTable"),H=r("Dialog");return h(),_("main",Z,[a(L,{class:"mb-6"},{end:l(()=>[a(g,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:R})]),_:1}),a(O,{ref_key:"dt",ref:w,value:T.fetchData,dataKey:"id",paginator:!0,rows:N.value,rowsPerPageOptions:[5,10,25],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",loading:V.value,filters:d.value,"onUpdate:filters":o[1]||(o[1]=e=>d.value=e),filterDisplay:"menu",showGridlines:"",globalFilterFields:["registrationname","email","eventid","registrationstatus","paymenttype"],onPage:F},{header:l(()=>[b("div",ee,[a(g,{type:"button",icon:"pi pi-filter-slash",label:"Clear",outlined:"",onClick:I}),a(M,null,{default:l(()=>[a(E,null,{default:l(()=>[...o[3]||(o[3]=[b("i",{class:"pi pi-search"},null,-1)])]),_:1}),a(u,{modelValue:d.value.global.value,"onUpdate:modelValue":o[0]||(o[0]=e=>d.value.global.value=e),placeholder:"Global Search"},null,8,["modelValue"])]),_:1})])]),empty:l(()=>[...o[4]||(o[4]=[f("No bookings found.",-1)])]),loading:l(()=>[...o[5]||(o[5]=[f("Loading event bookings...",-1)])]),default:l(()=>[a(s,{header:"No",style:{width:"4rem","text-align":"center"}},{body:l(({index:e,data:n})=>[f(y(x.value+e+1),1)]),_:1}),a(s,{field:"registrationno",header:"Reg No",sortable:"",style:{"min-width":"10rem"}}),a(s,{field:"registrationname",header:"Name",sortable:"",style:{"min-width":"12rem"}},{filter:l(({filterModel:e})=>[a(u,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,placeholder:"Search name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(s,{field:"email",header:"Email",sortable:"",style:{"min-width":"14rem"}},{filter:l(({filterModel:e})=>[a(u,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,placeholder:"Search email"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(s,{field:"registrationdate",header:"Date",sortable:"",dataType:"date",style:{"min-width":"10rem"}},{body:l(({data:e})=>[f(y(z(D)(e.registrationdate)),1)]),filter:l(({filterModel:e})=>[a(G,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,dateFormat:"yy-mm-dd",placeholder:"Select date"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(s,{field:"eventgroup",header:"Event Group",sortable:"",style:{"min-width":"8rem"}},{filter:l(({filterModel:e})=>[a(u,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,placeholder:"Event Group"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(s,{header:"Action",exportable:!1,style:{"min-width":"8rem"}},{body:l(({data:e})=>[a(g,{icon:"pi pi-eye",outlined:"",rounded:"",onClick:n=>A(e)},null,8,["onClick"])]),_:1})]),_:1},8,["value","rows","loading","filters"]),a(H,{visible:c.value,"onUpdate:visible":o[2]||(o[2]=e=>c.value=e),class:"w-[75%] xs:w-[330px] phone:w-[400px] sm:w-[480px]",header:"Booking Details",modal:""},{footer:l(()=>[a(g,{label:"Close",icon:"pi pi-times",text:"",onClick:U})]),default:l(()=>[p.value?(h(),_("div",ae,[(h(),_(X,null,Y(B,(e,n)=>b("div",{key:n,class:"flex flex-col"},[b("label",te,y(e.label),1),a(u,{value:e.format?e.format(p.value[n]):p.value[n],disabled:""},null,8,["value"])])),64))])):Q("",!0)]),_:1},8,["visible"])])}}});export{re as default};
