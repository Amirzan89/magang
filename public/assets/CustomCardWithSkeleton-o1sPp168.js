import{d as Z,y as x,a8 as W,m as aa,r as m,E as p,G as ea,e as ta,c as d,o as u,p as g,a as sa,i as $,K as j,a9 as E,F as R,k as _,n as na,O as oa,Q as la,w as ra,aa as f,v as ia,q as F,B as ua}from"./index-Xum_CI5g.js";const ca=Z({__name:"CustomCardWithSkeleton",props:{isLoading:{type:Boolean},inpVar:{},metaData:{},inpData:{},paralelRender:{},serverSide:{type:Boolean}},emits:["lazy-data"],setup(G,{emit:M}){const O=x(),e=G,h=M,D=a=>new Promise(t=>setTimeout(t,a)),y=new Map,k=W([]),z=W([]),i=aa([]),v=new Set,P=m(e.paralelRender??1),n=m(0),V=p(()=>e.inpData?.length),q=1/0;let b=0,w=0;const B=a=>{const t=Object.keys(F).reverse().find(r=>{const s=F[r];return typeof s=="object"&&"value"in s&&s.value&&r in a});return(t?a[t]:a.base)??1},K=a=>{const t=/([a-z0-9]*:)?grid-cols-(\d+)/g,r={};let s;for(;(s=t.exec(a))!==null;){const l=s[1]?.replace(":","")||"base";r[l]=parseInt(s[2],10)}return r},N=p(()=>K(e.metaData.customTWTransition??"")),C=()=>{const a=e.metaData.snapshots;return B(N.value)*(a&&typeof a=="object"?B(a):1)},S=m(!1),Q=m(0),o=m(C()),c=p(()=>C()),L=p(()=>e.serverSide?e.inpData:n.value==0?e.inpData?.slice(0,C())??[]:e.inpData?.slice(n.value,n.value+(o.value??0))??[]),A=p(()=>e.inpData&&e.inpData.length>0),H=p(()=>{const a=e.inpData??[],t=O["placeholder-card"]?[null]:[];return[...a,...t]}),J=a=>{const t=a?.wrapperKey||a?.event_id||"default";return y.has(t)||y.set(t,e.metaData.wrapper(a)),y.get(t)},U=async a=>{v.add(a),await D(10),k.value[a]?.classList.add("opacity-0"),await D(100),k.value[a]?.remove(),z.value[a]?.classList.remove("opacity-0"),await D(100),v.delete(a);const t=i.indexOf(a);t!==-1&&i.splice(t,1),T()},T=()=>{if(i.length!==0)for(;v.size<P.value&&i.length>0&&!(b>=q);){const a=i.shift();U(a),b++}},X=a=>{a>=n.value&&a<n.value+o.value?i.unshift(a):i.push(a),T()},Y=a=>{n.value=a.first,o.value=a.rows,e.metaData.pagination?.lazyLoading&&a.page+1+(e.metaData.pagination.preRenderPage??0)>=a.pageCount&&h("lazy-data",a)};return ea([()=>e.inpData?.length,c],([a])=>{if(S.value&&(a??0)>w){S.value=!1,w=a??0;return}if((c.value!==o.value||c.value!==0)&&(Q.value=o.value,n.value=Math.floor(n.value/o.value)*c.value,o.value=c.value,e.metaData.pagination)){e.metaData.pagination?.lazyLoading&&n.value+o.value>=(e.inpData?.length??0)&&(S.value=!0,w=a??0,h("lazy-data",null));const t=n.value,r=n.value+o.value;v.forEach(s=>{(s-1<t||s-1>=r)&&v.delete(s)}),i.sort((s,l)=>{const I=s-1>=t&&s-1<r;return(l-1>=t&&l-1<r?1:0)-(I?1:0)}),T()}}),ta(()=>{e.metaData.pagination&&e.metaData.pagination?.lazyLoading&&n.value+o.value>=(e.inpData?.length??0)&&h("lazy-data",null)}),(a,t)=>{const r=na("Paginator");return e.isLoading?(u(),d("div",{key:1,class:g(a.metaData.customTWTransition),style:E(a.metaData.customCSSTransition)},[(u(!0),d(R,null,_(c.value,s=>f(a.$slots,"default",{key:`loadingCard-${s}`},void 0,!0)),128))],6)):(u(),d("div",{key:0,class:g(a.metaData.customTWGrand)},[sa("div",{class:g(a.metaData.customTWTransition),style:E(a.metaData.customCSSTransition)},[A.value?(u(!0),d(R,{key:0},_(H.value,(s,l)=>oa((u(),$(ia(J(s)),{key:l<=e.inpData.length?s?.[e.metaData.pagination?.item_id]:`card-${l}-${e.inpData?.length}`},{default:ra(()=>[s&&l<e.inpData.length?(u(),d(R,{key:0},[f(a.$slots,"skeleton",{index:l,skeletonRefs:k.value},void 0,!0),f(a.$slots,"card",{index:l,inpData:s,toggleSkeleton:I=>X(I),cardRefs:z.value},void 0,!0)],64)):f(a.$slots,"placeholder-card",{key:1},void 0,!0)]),_:2},1024)),[[la,l>=n.value&&l<n.value+o.value]])),128)):j("",!0)],6),a.metaData.pagination&&L.value&&L.value.length>0?(u(),$(r,{key:0,class:g(["flex justify-center",a.metaData.pagination.customTWPaginator]),first:n.value,rows:o.value,totalRecords:V.value,onPage:Y},null,8,["class","first","rows","totalRecords"])):j("",!0)],2))}}}),ma=ua(ca,[["__scopeId","data-v-235e7aa4"]]);export{ma as C};
